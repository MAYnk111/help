#include <iostream>
#include <string>
using namespace std;

const int TABLE_SIZE = 10;

// Structure to store account information
struct Account {
    int accNumber;
    string name;
    double balance;
    bool occupied;
    bool deleted;

    Account() {
        accNumber = -1;
        name = "";
        balance = 0.0;
        occupied = false;
        deleted = false;
    }
};

// Hash Table array
Account hashTable[TABLE_SIZE];

// ---------- Hash Function ----------
int hashFunction(int accNumber) {
    return accNumber % TABLE_SIZE;
}

// ---------- Insert Account ----------
void insertAccount(int accNumber, string name, double balance) {
    int index = hashFunction(accNumber);
    int start = index;

    while (hashTable[index].occupied && !hashTable[index].deleted) {
        if (hashTable[index].accNumber == accNumber) {
            cout << "Account already exists! Duplicate not allowed.\n";
            return;
        }
        index = (index + 1) % TABLE_SIZE;
        if (index == start) {
            cout << "Hash table is full! Cannot insert new record.\n";
            return;
        }
    }

    hashTable[index].accNumber = accNumber;
    hashTable[index].name = name;
    hashTable[index].balance = balance;
    hashTable[index].occupied = true;
    hashTable[index].deleted = false;
    cout << "Account inserted successfully at index " << index << ".\n";
}

// ---------- Search Account ----------
void searchAccount(int accNumber) {
    int index = hashFunction(accNumber);
    int start = index;

    while (hashTable[index].occupied || hashTable[index].deleted) {
        if (hashTable[index].occupied && hashTable[index].accNumber == accNumber) {
            cout << "\nAccount Found:\n";
            cout << "Account Number: " << hashTable[index].accNumber << endl;
            cout << "Name: " << hashTable[index].name << endl;
            cout << "Balance: " << hashTable[index].balance << endl;
            return;
        }
        index = (index + 1) % TABLE_SIZE;
        if (index == start)
            break;
    }
    cout << "Account not found.\n";
}

// ---------- Delete Account ----------
void deleteAccount(int accNumber) {
    int index = hashFunction(accNumber);
    int start = index;

    while (hashTable[index].occupied || hashTable[index].deleted) {
        if (hashTable[index].occupied && hashTable[index].accNumber == accNumber) {
            hashTable[index].occupied = false;
            hashTable[index].deleted = true;
            cout << "Account deleted successfully.\n";
            return;
        }
        index = (index + 1) % TABLE_SIZE;
        if (index == start)
            break;
    }
    cout << "Account not found.\n";
}

// ---------- Display Hash Table ----------
void displayTable() {
    cout << "\n--- Hash Table (Bank Accounts) ---\n";
    cout << "Index\tAccount No\tName\t\tBalance\n";
    cout << "-----------------------------------------------\n";

    for (int i = 0; i < TABLE_SIZE; i++) {
        if (hashTable[i].occupied)
            cout << i << "\t" << hashTable[i].accNumber << "\t\t"
                 << hashTable[i].name << "\t\t" << hashTable[i].balance << endl;
        else
            cout << i << "\t--- Empty ---\n";
    }
}

// ---------- MAIN FUNCTION ----------
int main() {
    int choice, accNumber;
    string name;
    double balance;

    do {
        cout << "\n--- Bank Account Management (Hash Table) ---\n";
        cout << "1. Insert Account\n2. Search Account\n3. Delete Account\n4. Display All\n5. Exit\n";
        cout << "Enter your choice: ";
        cin >> choice;

        switch (choice) {
            case 1:
                cout << "Enter Account Number, Name, and Balance: ";
                cin >> accNumber >> name >> balance;
                insertAccount(accNumber, name, balance);
                break;

            case 2:
                cout << "Enter Account Number to search: ";
                cin >> accNumber;
                searchAccount(accNumber);
                break;

            case 3:
                cout << "Enter Account Number to delete: ";
                cin >> accNumber;
                deleteAccount(accNumber);
                break;

            case 4:
                displayTable();
                break;

            case 5:
                cout << "Exiting program.\n";
                break;

            default:
                cout << "Invalid choice! Try again.\n";
        }
    } while (choice != 5);

    return 0;
}
